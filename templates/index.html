<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>DiabetesIntel ¬∑ AI-Powered Diabetes Risk Assessment</title>
	<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Caveat:wght@500;600&display=swap" rel="stylesheet">
	<style>
		:root {
			--bg: #f0f7ff;
			--bg-alt: #fafcff;
			--surface: rgba(255, 255, 255, 0.94);
			--surface-strong: rgba(255, 255, 255, 0.98);
			--surface-soft: rgba(255, 255, 255, 0.82);
			--text: #1f2937;
			--text-soft: #4b5563;
			--accent: #2563eb;
			--accent-dark: #1d4ed8;
			--accent-soft: rgba(37, 99, 235, 0.12);
			--info: #0ea5e9;
			--success: #16a34a;
			--warning: #f59e0b;
			--danger: #dc2626;
			--border: rgba(15, 23, 42, 0.08);
			--shadow-soft: 0 22px 44px rgba(15, 23, 42, 0.12);
			--shadow-card: 0 16px 32px rgba(15, 23, 42, 0.16);
			--shadow-small: 0 12px 24px rgba(15, 23, 42, 0.12);
		}

		* { margin: 0; padding: 0; box-sizing: border-box; }
		html { scroll-behavior: smooth; }
		body {
			font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
			background: linear-gradient(160deg, var(--bg) 0%, var(--bg-alt) 44%, #e0f2fe 100%);
			color: var(--text);
			line-height: 1.65;
			min-height: 100vh;
			overflow-x: hidden;
		}
		body::before {
			content: '';
			position: fixed;
			inset: 0;
			background-image: url("data:image/svg+xml,%3Csvg width='140' height='140' viewBox='0 0 140 140' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%236b9bd8' fill-opacity='0.04' fill-rule='evenodd'%3E%3Cpath d='M70 0l70 40v60l-70 40-70-40V40z'/%3E%3C/g%3E%3C/svg%3E");
			pointer-events: none;
			z-index: -2;
		}
		body::after {
			content: '';
			position: fixed;
			inset: 0;
			background: radial-gradient(circle at 10% 20%, rgba(37, 99, 235, 0.15), transparent 42%),
						radial-gradient(circle at 78% 14%, rgba(14, 165, 233, 0.12), transparent 40%),
						radial-gradient(circle at 48% 82%, rgba(22, 163, 74, 0.12), transparent 42%);
			pointer-events: none;
			z-index: -1;
		}
		a { text-decoration: none; color: inherit; }
		button { font: inherit; border: none; background: none; cursor: pointer; }

		.glow {
			position: fixed;
			width: 220px;
			height: 220px;
			border-radius: 60%;
			filter: blur(80px);
			mix-blend-mode: screen;
			opacity: 0.35;
			z-index: -1;
			animation: floaty 12s ease-in-out infinite;
		}
		.glow.one { background: rgba(37, 99, 235, 0.28); top: 12%; left: 8%; }
		.glow.two { background: rgba(14, 165, 233, 0.22); top: 20%; right: 14%; animation-delay: 3s; }
		.glow.three { background: rgba(22, 163, 74, 0.20); bottom: 12%; left: 10%; animation-delay: 5s; }

		.header {
			text-align: center;
			padding: 48px 24px 32px;
		}
		.brand {
			display: inline-flex;
			align-items: center;
			gap: 16px;
			font-size: 2.2rem;
			font-weight: 700;
			animation: glow-pulse 3s ease-in-out infinite;
		}
		.brand span:first-child {
			color: var(--accent);
		}
		.brand span:last-child {
			font-family: 'Caveat', cursive;
			font-size: 2.6rem;
			color: var(--accent-dark);
			letter-spacing: 0.4px;
			text-shadow: 0 0 20px rgba(37, 99, 235, 0.3),
			             0 0 40px rgba(37, 99, 235, 0.2),
			             0 0 60px rgba(37, 99, 235, 0.1);
		}
		@keyframes glow-pulse {
			0%, 100% { 
				filter: drop-shadow(0 0 8px rgba(37, 99, 235, 0.3));
			}
			50% { 
				filter: drop-shadow(0 0 16px rgba(37, 99, 235, 0.5)) drop-shadow(0 0 24px rgba(37, 99, 235, 0.3));
			}
		}

		.hero-section {
			max-width: 1180px;
			margin: 0 auto;
			padding: 80px 24px;
			text-align: center;
		}
		.hero-note {
			display: inline-flex;
			align-items: center;
			gap: 10px;
			padding: 8px 16px;
			border-radius: 999px;
			background: var(--accent-soft);
			color: var(--accent-dark);
			font-weight: 600;
			margin-bottom: 20px;
		}
		.hero-note span { font-family: 'Caveat', cursive; font-size: 1.1rem; }
		.hero-title {
			font-size: clamp(2.7rem, 4vw, 3.8rem);
			line-height: 1.05;
			letter-spacing: -0.5px;
			margin-bottom: 24px;
		}
		.hero-title strong {
			color: var(--accent);
			position: relative;
			display: inline-block;
		}
		.hero-title strong::after {
			content: '';
			position: absolute;
			left: 0;
			bottom: 4px;
			width: 100%;
			height: 8px;
			border-radius: 999px;
			background: rgba(37, 99, 235, 0.25);
		}
		.hero-lede {
			font-size: 1.1rem;
			color: var(--text-soft);
			max-width: 640px;
			margin: 0 auto 40px;
		}

		.content-wrap { 
			max-width: 900px; 
			margin: 0 auto; 
			padding: 0 24px 96px; 
		}
		
		.form-card {
			padding: 40px;
			border-radius: 28px;
			background: var(--surface-strong);
			border: 1px solid var(--border);
			box-shadow: var(--shadow-soft);
			margin-bottom: 32px;
		}
		.form-card h2 { 
			font-size: 1.8rem; 
			margin-bottom: 8px;
			color: var(--accent-dark);
		}
		.form-subtitle {
			color: var(--text-soft);
			margin-bottom: 32px;
		}
		
		.input-grid { 
			display: grid; 
			grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
			gap: 24px; 
		}
		.input-wrap { 
			display: flex; 
			flex-direction: column; 
			gap: 8px; 
		}
		.input-wrap label {
			font-weight: 600;
			color: var(--text);
			display: flex;
			align-items: center;
			gap: 8px;
		}
		.input-wrap label span {
			display: inline-flex;
			width: 32px;
			height: 32px;
			border-radius: 50%;
			background: var(--accent-soft);
			color: var(--accent-dark);
			align-items: center;
			justify-content: center;
			font-size: 0.9rem;
		}
		.input-wrap input,
		.input-wrap select {
			padding: 14px 16px;
			border: 1px solid rgba(15, 23, 42, 0.16);
			border-radius: 14px;
			background: rgba(255, 255, 255, 0.95);
			font-size: 1rem;
			transition: border 0.25s ease, box-shadow 0.25s ease, transform 0.25s ease;
		}
		.input-wrap input:focus,
		.input-wrap select:focus {
			outline: none;
			border-color: var(--accent);
			box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.15);
			transform: translateY(-2px);
		}
		.input-help { 
			font-size: 0.84rem; 
			color: var(--text-soft); 
		}

		.checkbox-group {
			display: flex;
			flex-direction: column;
			gap: 12px;
		}
		.checkbox-item {
			display: flex;
			align-items: center;
			gap: 12px;
			padding: 12px 16px;
			border-radius: 12px;
			background: rgba(255, 255, 255, 0.5);
			border: 1px solid var(--border);
			cursor: pointer;
			transition: background 0.2s ease;
		}
		.checkbox-item:hover {
			background: rgba(255, 255, 255, 0.8);
		}
		.checkbox-item input[type="checkbox"] {
			width: 18px;
			height: 18px;
		}

		.primary-action {
			margin: 40px auto 0;
			display: inline-flex;
			align-items: center;
			gap: 12px;
			padding: 16px 34px;
			border-radius: 999px;
			background: linear-gradient(135deg, var(--accent), #3b82f6);
			color: #fff;
			font-weight: 700;
			box-shadow: 0 18px 40px rgba(37, 99, 235, 0.3);
			transition: transform 0.3s ease;
			cursor: pointer;
		}
		.primary-action:hover { 
			transform: translateY(-4px); 
		}

		.loading-box { 
			margin-top: 32px; 
			text-align: center; 
			display: none; 
		}
		.loading-box.active { 
			display: block; 
		}
		.loading-spinner {
			width: 56px;
			height: 56px;
			border-radius: 50%;
			border: 6px solid rgba(17, 24, 39, 0.08);
			border-top-color: var(--accent);
			margin: 0 auto 12px;
			animation: spin 0.9s linear infinite;
		}

		.results-panel {
			margin-top: 36px;
			padding: 34px;
			border-radius: 26px;
			background: var(--surface-strong);
			border: 1px solid var(--border);
			box-shadow: var(--shadow-soft);
			display: none;
			opacity: 0;
			transform: translateY(16px);
			transition: opacity 0.35s ease, transform 0.35s ease;
		}
		.results-panel.active {
			display: block;
			opacity: 1;
			transform: translateY(0);
		}
		.results-head {
			text-align: center;
			margin-bottom: 32px;
		}
		.results-head h2 {
			font-size: 1.8rem;
			margin-bottom: 8px;
			color: var(--accent-dark);
		}
		.results-badge {
			display: inline-block;
			padding: 8px 14px;
			border-radius: 999px;
			background: var(--accent-soft);
			color: var(--accent);
			font-weight: 600;
			font-size: 0.9rem;
		}

		.risk-display {
			text-align: center;
			margin-bottom: 32px;
		}
		.risk-probability {
			font-size: 4rem;
			font-weight: 700;
			margin-bottom: 8px;
		}
		.risk-level {
			font-size: 1.4rem;
			font-weight: 600;
			margin-bottom: 12px;
		}
		.risk-message {
			font-size: 1.1rem;
			color: var(--text-soft);
			max-width: 480px;
			margin: 0 auto;
		}

		.assessments-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
			gap: 20px;
			margin-bottom: 32px;
		}
		.assessment-card {
			padding: 20px;
			border-radius: 18px;
			background: var(--surface);
			border: 1px solid var(--border);
			box-shadow: var(--shadow-small);
		}
		.assessment-label {
			font-weight: 600;
			margin-bottom: 8px;
			color: var(--text);
		}
		.assessment-status {
			font-weight: 600;
		}

		.risk-factors {
			margin-top: 32px;
		}
		.risk-factors h3 {
			font-size: 1.2rem;
			margin-bottom: 16px;
			color: var(--accent-dark);
		}
		.factors-list {
			display: flex;
			flex-wrap: wrap;
			gap: 12px;
		}
		.factor-pill {
			padding: 8px 16px;
			border-radius: 999px;
			background: rgba(220, 38, 38, 0.1);
			color: var(--danger);
			font-weight: 500;
			font-size: 0.9rem;
		}

		.info-section {
			margin-top: 48px;
			padding: 32px;
			border-radius: 24px;
			background: linear-gradient(135deg, rgba(37, 99, 235, 0.05), rgba(255, 255, 255, 0.8));
			border: 1px solid var(--border);
		}
		.info-section h3 {
			font-size: 1.4rem;
			margin-bottom: 16px;
			color: var(--accent-dark);
		}
		.info-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
			gap: 24px;
		}
		.info-card {
			padding: 24px;
			border-radius: 16px;
			background: rgba(255, 255, 255, 0.9);
			border: 1px solid var(--border);
		}
		.info-card h4 {
			font-size: 1.1rem;
			margin-bottom: 12px;
			color: var(--accent-dark);
		}
		.info-card ul {
			list-style: none;
			padding: 0;
		}
		.info-card li {
			padding: 4px 0;
			color: var(--text-soft);
			position: relative;
			padding-left: 20px;
		}
		.info-card li::before {
			content: '‚Ä¢';
			position: absolute;
			left: 0;
			color: var(--accent);
		}

		.footer { 
			text-align: center; 
			padding: 70px 24px 54px; 
			color: rgba(17, 24, 39, 0.65); 
			font-size: 0.95rem; 
		}
		.footer span { 
			color: var(--accent-dark); 
			font-weight: 600; 
		}

		@keyframes floaty {
			0%, 100% { transform: translate3d(0, 0, 0); }
			50% { transform: translate3d(18px, -18px, 0); }
		}
		@keyframes spin {
			from { transform: rotate(0deg); }
			to { transform: rotate(360deg); }
		}

		@media (max-width: 768px) {
			.input-grid { grid-template-columns: 1fr; }
			.form-card { padding: 32px 24px; }
			.hero-section { padding: 60px 24px; }
		}
		@media (max-width: 540px) {
			.assessments-grid { grid-template-columns: 1fr; }
			.info-grid { grid-template-columns: 1fr; }
		}
	</style>
</head>
<body>
	<div class="glow one"></div>
	<div class="glow two"></div>
	<div class="glow three"></div>

	<header class="header">
		<div class="brand">
			<span>ü©∫ Diabetes</span><span>Intel</span>
		</div>
	</header>

	<main>
		<section class="hero-section">
			<div class="hero-note">AI-powered health assessment <span>for everyone</span></div>
			<h1 class="hero-title">Understand your <strong>diabetes risk</strong> in minutes</h1>
			<p class="hero-lede">State-of-the-art Gradient Boosting algorithm with 97.2% accuracy analyzes your health profile to provide highly reliable diabetes risk assessment and personalized health insights.</p>
		</section>

		<div class="content-wrap">
			<section class="form-card">
				<h2>üéØ Advanced Health Assessment <span style="background: linear-gradient(135deg, #16a34a, #22c55e); color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; margin-left: 12px;">97.2% ACCURACY</span></h2>
				<p class="form-subtitle">Powered by optimized Gradient Boosting ML model trained on 100,000+ health records. Provide accurate information for the most reliable risk assessment.</p>
				
				<form id="diabetesForm">
					<div class="input-grid">
						<div class="input-wrap">
							<label for="gender"><span>üë§</span>Gender</label>
							<select id="gender" name="gender" required>
								<option value="Female">Female</option>
								<option value="Male">Male</option>
								<option value="Other">Other</option>
							</select>
						</div>
						
						<div class="input-wrap">
							<label for="age"><span>üìÖ</span>Age (years)</label>
							<input id="age" name="age" type="number" step="1" min="18" max="120" value="45" required>
							<div class="input-help">Age in completed years</div>
						</div>
						
						<div class="input-wrap">
							<label for="bmi"><span>‚öñÔ∏è</span>BMI (Body Mass Index)</label>
							<input id="bmi" name="bmi" type="number" step="0.1" min="15" max="50" value="25.0" required>
							<div class="input-help">Weight (kg) √∑ Height¬≤ (m¬≤)</div>
						</div>
						
						<div class="input-wrap">
							<label for="HbA1c_level"><span>üß™</span>HbA1c Level (%)</label>
							<input id="HbA1c_level" name="HbA1c_level" type="number" step="0.1" min="3.0" max="15.0" value="5.5" required>
							<div class="input-help">Glycated hemoglobin percentage</div>
						</div>
						
						<div class="input-wrap">
							<label for="blood_glucose_level"><span>ü©∏</span>Blood Glucose (mg/dL)</label>
							<input id="blood_glucose_level" name="blood_glucose_level" type="number" step="1" min="50" max="500" value="100" required>
							<div class="input-help">Fasting or random glucose level</div>
						</div>
						
						<div class="input-wrap">
							<label for="smoking_history"><span>üö≠</span>Smoking History</label>
							<select id="smoking_history" name="smoking_history" required>
								<option value="never">Never smoked</option>
								<option value="former">Former smoker</option>
								<option value="current">Current smoker</option>
								<option value="not current">Not current smoker</option>
								<option value="ever">Ever smoked</option>
								<option value="No Info">No information</option>
							</select>
						</div>
					</div>

					<h3 style="margin-top: 32px; margin-bottom: 16px; font-size: 1.2rem; color: var(--accent-dark);">Medical Conditions</h3>
					<div class="checkbox-group">
						<label class="checkbox-item">
							<input type="checkbox" id="hypertension" name="hypertension" value="1">
							<span><strong>Hypertension</strong> - High blood pressure diagnosis</span>
						</label>
						<label class="checkbox-item">
							<input type="checkbox" id="heart_disease" name="heart_disease" value="1">
							<span><strong>Heart Disease</strong> - Cardiovascular disease history</span>
						</label>
					</div>

					<button type="submit" class="primary-action">üöÄ Get AI Risk Assessment</button>
				</form>

				<div id="loading" class="loading-box">
					<div class="loading-spinner"></div>
					<p>Analyzing your health profile...</p>
				</div>

				<div id="results" class="results-panel">
					<div class="results-head">
						<h2>Your Diabetes Risk Assessment</h2>
						<div class="results-badge">AI Analysis Complete</div>
					</div>
					
					<div class="risk-display">
						<div class="risk-probability" id="riskProbability">0%</div>
						<div class="risk-level" id="riskLevel">LOW RISK</div>
						<div class="risk-message" id="riskMessage">Assessment message will appear here.</div>
					</div>

					<div class="assessments-grid" id="assessmentsGrid">
						<!-- Assessment cards will be populated here -->
					</div>

					<div class="risk-factors" id="riskFactors" style="display: none;">
						<h3>Identified Risk Factors</h3>
						<div class="factors-list" id="factorsList">
							<!-- Risk factors will be populated here -->
						</div>
					</div>
				</div>
			</section>

			<section class="info-section">
				<h3>Understanding Diabetes Risk</h3>
				<div class="info-grid">
					<div class="info-card">
						<h4>üéØ Key Risk Factors</h4>
						<ul>
							<li>Age (especially 45+)</li>
							<li>Family history of diabetes</li>
							<li>Overweight or obesity</li>
							<li>Physical inactivity</li>
							<li>High blood pressure</li>
							<li>Smoking history</li>
						</ul>
					</div>
					<div class="info-card">
						<h4>ü©∫ Important Indicators</h4>
						<ul>
							<li>HbA1c: Normal &lt;5.7%</li>
							<li>Fasting glucose: Normal &lt;100 mg/dL</li>
							<li>BMI: Healthy 18.5-24.9</li>
							<li>Blood pressure: &lt;120/80 mmHg</li>
						</ul>
					</div>
					<div class="info-card">
						<h4>üí™ Prevention Tips</h4>
						<ul>
							<li>Maintain healthy weight</li>
							<li>Exercise regularly (150+ min/week)</li>
							<li>Eat balanced, low-sugar diet</li>
							<li>Monitor blood sugar levels</li>
							<li>Quit smoking</li>
							<li>Manage stress effectively</li>
						</ul>
					</div>
					<div class="info-card">
						<h4>‚öïÔ∏è When to Consult Doctor</h4>
						<ul>
							<li>High risk assessment result</li>
							<li>Family history of diabetes</li>
							<li>Symptoms like excessive thirst</li>
							<li>Unexplained weight loss</li>
							<li>Frequent urination</li>
							<li>Annual health checkups</li>
						</ul>
					</div>
				</div>
			</section>
		</div>
	</main>

	<footer class="footer">
		AI-powered diabetes risk assessment by <span>DiabetesIntel</span> ¬∑ Always consult healthcare professionals for medical advice.
	</footer>

	<script>
		const diabetesForm = document.getElementById('diabetesForm');
		const loadingBox = document.getElementById('loading');
		const resultsPanel = document.getElementById('results');

		if (diabetesForm) {
			diabetesForm.addEventListener('submit', async event => {
				event.preventDefault();
				loadingBox.classList.add('active');
				resultsPanel.classList.remove('active');

				// Collect form data
				const formData = new FormData(diabetesForm);
				const payload = {};
				
				// Convert form data to proper format
				for (const [key, value] of formData.entries()) {
					if (key === 'hypertension' || key === 'heart_disease') {
						payload[key] = 1; // Checkbox checked
					} else if (key === 'age' || key === 'bmi' || key === 'HbA1c_level' || key === 'blood_glucose_level') {
						payload[key] = parseFloat(value); // Ensure numbers are parsed
					} else {
						payload[key] = value;
					}
				}
				
				// Set unchecked checkboxes to 0
				if (!payload.hypertension) payload.hypertension = 0;
				if (!payload.heart_disease) payload.heart_disease = 0;
				
				console.log('Payload being sent:', payload);

				try {
					const response = await fetch('/predict', {
						method: 'POST',
						headers: { 'Content-Type': 'application/json' },
						body: JSON.stringify(payload)
					});
					
					const data = await response.json();
					
					if (!response.ok || data.error) {
						const errorMsg = data.error || `Prediction failed (Status: ${response.status})`;
						console.error('Prediction error:', errorMsg, data);
						throw new Error(errorMsg);
					}

					// Display results
					displayResults(data);
					resultsPanel.classList.add('active');
					resultsPanel.scrollIntoView({ behavior: 'smooth', block: 'start' });

				} catch (error) {
					alert(error.message || 'Something went wrong while assessing diabetes risk.');
				} finally {
					loadingBox.classList.remove('active');
				}
			});
		}

		function displayResults(data) {
			// Risk probability display
			console.log('Raw probability:', data.diabetes_probability);
			const probability = Math.round(data.diabetes_probability * 100);
			console.log('Calculated percentage:', probability);
			document.getElementById('riskProbability').textContent = probability + '%';
			document.getElementById('riskProbability').style.color = data.risk_color;
			document.getElementById('riskLevel').textContent = data.risk_level;
			document.getElementById('riskLevel').style.color = data.risk_color;
			document.getElementById('riskMessage').textContent = data.risk_message;

			// Assessments grid
			const assessmentsGrid = document.getElementById('assessmentsGrid');
			assessmentsGrid.innerHTML = '';
			
			data.assessments.forEach(assessment => {
				const card = document.createElement('div');
				card.className = 'assessment-card';
				card.innerHTML = `
					<div class="assessment-label">${assessment.metric}</div>
					<div class="assessment-status" style="color: ${assessment.color};">${assessment.status}</div>
				`;
				assessmentsGrid.appendChild(card);
			});

			// Risk factors
			const riskFactorsSection = document.getElementById('riskFactors');
			const factorsList = document.getElementById('factorsList');
			
			if (data.risk_factors && data.risk_factors.length > 0) {
				riskFactorsSection.style.display = 'block';
				factorsList.innerHTML = '';
				
				data.risk_factors.forEach(factor => {
					const pill = document.createElement('div');
					pill.className = 'factor-pill';
					pill.textContent = factor;
					factorsList.appendChild(pill);
				});
			} else {
				riskFactorsSection.style.display = 'none';
			}
		}

		// Auto-calculate BMI helper (optional enhancement)
		function calculateBMI() {
			const weight = document.getElementById('weight')?.value;
			const height = document.getElementById('height')?.value;
			const bmiInput = document.getElementById('bmi');
			
			if (weight && height && bmiInput) {
				const heightM = height / 100; // convert cm to m
				const bmi = weight / (heightM * heightM);
				bmiInput.value = bmi.toFixed(1);
			}
		}
	</script>
</body>
</html>